# Create Kubernetes Resources via CLI Dry-Run (YAML Templates)

This document shows **how to generate exact Kubernetes YAML manifests using command-line dry-run**, for different resource types (Deployment, DaemonSet, Job, Service, etc.).

> Key idea: **kubectl can generate YAML only for resources that have a generator or imperative command support.**

---

## 1. The Core Pattern (Must Remember)

```bash
kubectl <command> <resource> <name> \
  [flags] \
  --dry-run=client -o yaml > resource.yaml
```

* `--dry-run=client` → nothing is created
* `-o yaml` → output manifest
* `>` → save as template

---

## 2. Deployment (Most Common)

```bash
kubectl create deployment nginx-deploy \
  --image=nginx \
  --replicas=3 \
  --dry-run=client -o yaml > deployment.yaml
```

---

## 3. Pod

```bash
kubectl run nginx-pod \
  --image=nginx \
  --restart=Never \
  --dry-run=client -o yaml > pod.yaml
```

---

## 4. Job

```bash
kubectl create job batch-job \
  --image=busybox \
  --dry-run=client -o yaml \
  -- echo "Hello Kubernetes" > job.yaml
```

Produces a proper **Job** manifest.

---

## 5. CronJob

```bash
kubectl create cronjob hello-cron \
  --image=busybox \
  --schedule="*/5 * * * *" \
  --dry-run=client -o yaml \
  -- echo "Hello" > cronjob.yaml
```

---

## 6. Service (ClusterIP / NodePort)

```bash
kubectl expose deployment nginx-deploy \
  --port=80 \
  --target-port=80 \
  --type=ClusterIP \
  --dry-run=client -o yaml > service.yaml
```

---

## 7. ConfigMap

```bash
kubectl create configmap app-config \
  --from-literal=ENV=prod \
  --dry-run=client -o yaml > configmap.yaml
```

---

## 8. Secret (Opaque)

```bash
kubectl create secret generic db-secret \
  --from-literal=user=admin \
  --from-literal=password=secret \
  --dry-run=client -o yaml > secret.yaml
```

---

## 9. Namespace

```bash
kubectl create namespace test-ns \
  --dry-run=client -o yaml > namespace.yaml
```

---

## 10. ❌ DaemonSet — Important Limitation

There is **NO `kubectl create daemonset` generator**.

So this command does **not exist**:

```bash
kubectl create daemonset fluentd --image=fluentd
```

### Correct Way to Create DaemonSet YAML

Use one of these approaches:

### Option 1: Copy from Deployment Template (Recommended)

1. Generate Deployment YAML:

```bash
kubectl create deployment fluentd \
  --image=fluentd \
  --dry-run=client -o yaml > daemonset.yaml
```

2. Edit the file:

* Change `kind: Deployment` → `DaemonSet`
* Remove `replicas`
* Keep `selector` and `template`

---

### Option 2: Official Docs / Snippet Template

Manually write minimal DaemonSet:

```yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: fluentd
spec:
  selector:
    matchLabels:
      app: fluentd
  template:
    metadata:
      labels:
        app: fluentd
    spec:
      containers:
      - name: fluentd
        image: fluentd
```

---

## 11. Resource Types That Support Dry-Run Generators

| Resource    | CLI Dry-Run Support |
| ----------- | ------------------- |
| Pod         | Yes                 |
| Deployment  | Yes                 |
| Job         | Yes                 |
| CronJob     | Yes                 |
| Service     | Yes                 |
| ConfigMap   | Yes                 |
| Secret      | Yes                 |
| Namespace   | Yes                 |
| DaemonSet   | ❌ No                |
| StatefulSet | ❌ No                |
| Ingress     | ❌ No                |

---

## 12. Best Practice (Real-World)

* Use CLI dry-run for **quick templates**
* Edit YAML for unsupported resources
* Commit cleaned YAML to Git
* Use `kubectl apply` for lifecycle management

---

## 13. Interview One-Liner ⭐

> kubectl dry-run can generate YAML only for resources with imperative generators; resources like DaemonSet and StatefulSet must be written manually or adapted from Deployment templates.

---

End of document.
